---
- name: This is a test for ale_aos_command module
  hosts: alcatel
  connection: local
  roles:
    - gmoisio.ale_aos
  vars:
    ansible_python_interpreter: "python"
  tasks:
    - name: Add vlan {{ vlan_name }} with vid {{ vlan_id }}
      ale_aos_command:
        host: "{{ inventory_hostname }}"
        username: "{{ login }}"
        password: "{{ password }}"
        command: vlan {{ vlan_id }} enable name {{ vlan_name }}
    - name: Get Vlan port
      ale_aos_command:
        host: "{{ inventory_hostname }}"
        username: "{{ login }}"
        password: "{{ password }}"
        command: show vlan port
        timing: True
      register: vlan_list
    - set_fact:
        new_list: "{{ new_list | default([]) + [item] }}"
      with_items: "{{ vlan_list }}"
      when: '"qtagged" in item'
    - debug: var=new_list
